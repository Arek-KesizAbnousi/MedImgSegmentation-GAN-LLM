# Enhanced Medical Image Segmentation with Generative AI and LLM Integration

## Description

This project focuses on developing an enhanced medical image segmentation system that integrates **Generative Adversarial Networks (GANs)** for data augmentation and a **Large Language Model (LLM)** for generating descriptive reports based on segmentation results. The system uses a **U-Net** model for segmentation and incorporates **GPT-2** as the LLM to provide detailed insights into the segmentation outputs. The entire project leverages **NVIDIA GPUs** and relevant technologies for accelerated computing.

## Table of Contents

- [Project Overview](#project-overview)
- [Project Structure](#project-structure)
- [Installation](#installation)
- [Dataset Preparation](#dataset-preparation)
- [Usage](#usage)
  - [1. Data Preprocessing](#1-data-preprocessing)
  - [2. GAN Training](#2-gan-training)
  - [3. U-Net Training](#3-u-net-training)
  - [4. LLM Integration](#4-llm-integration)
  - [5. Running the Full Pipeline](#5-running-the-full-pipeline)
- [Results](#results)
- [Visualization](#visualization)
- [Contributing](#contributing)
- [License](#license)
- [Acknowledgments](#acknowledgments)


## Project Overview

The goal of this project is to enhance medical image segmentation performance by:

- **Data Augmentation**: Using a Generative Adversarial Network (GAN) to generate synthetic medical images, thereby increasing dataset diversity.
- **Image Segmentation**: Implementing a U-Net model for accurate segmentation of medical images.
- **Report Generation**: Integrating a pre-trained GPT-2 model to generate descriptive textual reports based on the segmentation outputs.

**Key Technologies and Tools:**

- **Programming Language**: Python 3.x
- **Deep Learning Framework**: PyTorch
- **Libraries**: NumPy, Matplotlib, scikit-learn, torchvision, transformers, Pillow
- **Hardware**: NVIDIA GPU with CUDA for accelerated computing
- **Dataset**: ISIC Skin Cancer Dataset

## Project Structure
```plaintext
MedSegGAN-LLM/
├── data/
│   ├── images/                   # Original images
│   ├── masks/                    # Original segmentation masks
│   ├── augmented_images/         # Synthetic images generated by GAN
│   └── augmented_masks/          # Corresponding masks for synthetic images (if applicable)
├── results/
│   ├── generated_images/         # Images generated during GAN training
│   ├── segmentation_outputs/     # Output masks from the segmentation model
│   └── reports/                  # Generated textual reports from LLM
├── src/
│   ├── data_preprocessing.py     # Data loading and preprocessing functions
│   ├── gan_training.py           # GAN model training script
│   ├── unet_training.py          # U-Net model training script
│   ├── llm_integration.py        # LLM integration for report generation
│   ├── neural_networks.py        # Neural network architectures (GAN and U-Net)
│   ├── utils.py                  # Utility functions (e.g., visualization)
│   └── main.py                   # Main script to run the entire pipeline
├── requirements.txt              # Required Python libraries
├── README.md                     # Documentation
```

## Installation

### Prerequisites

- **Python 3.8** or higher
- **CUDA Toolkit** (for GPU acceleration)
- **An NVIDIA GPU** compatible with CUDA
- **Anaconda** or **virtualenv** (recommended for environment management)

### Steps

1. **Clone the Repository**

   ```bash
   git clone https://github.com/Arek-KesizAbnousi/MedImgSegmentation-GAN-LLM.git
   cd MedImgSegmentation-GAN-LLM

2. **Create a Virtual Environment**

Using Anaconda:
```bash
conda create -n medseg_env python=3.8
conda activate medseg_env
```
Or using virtualenv:
```
python3 -m venv medseg_env
source medseg_env/bin/activate
```
3. **Install Required Packages**
```
pip install -r requirements.txt
```
4. **Verify CUDA Installation**
   Ensure that PyTorch detects the GPU:
```
python -c "import torch; print(torch.cuda.is_available())"
```
The output should be True.

## Dataset Preparation
1. Download the ISIC Skin Cancer Dataset
   - Register on the ISIC Archive.
   - Download the dataset, including images and corresponding segmentation masks.

2. Data Preprocessing
   -Run the data preprocessing script to prepare the datasets.
   ```
   python src/data_preprocessing.py
   ```
   -Functionality:

     -Loads images and masks.
     -Resizes and normalizes images.
     -Splits data into training and validation sets.

## Usage
   ### 1. Data Preprocessing
   
   ### 2. GAN Training
   
   ### 3. U-Net Training
   
   ### 4. LLM Integration
   
   ### 5. Running the Full Pipeline
   
## Results


## Visualization
## Contributing
## License

## Acknowledgments
